<!doctype html>
<html lang="en">

<head>






<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
<meta name="generator" content="Orchid 0.21.1"/>
<link rel="icon" href="https://monkeypatch.io/kaval/favicon.ico">


<meta name="robots" content="index, follow">



<title>Samples</title>


<meta name="description" content="Kaval is a validation DSL for your POJO.">





<!-- start:inject styles -->
<link rel="stylesheet" type="text/css" href="https://monkeypatch.io/kaval/Default/878a6be4/assets/css/kaval.css"  />
<link rel="stylesheet" type="text/css" href="https://monkeypatch.io/kaval/ajax/libs/prism/1.17.1/themes/prism-tomorrow.min.css"  />
<!-- end:inject styles -->



<script>
    window.site = {"orchidVersion":"0.21.1","baseUrl":"https://monkeypatch.io/kaval","environment":"prod","version":"0.6.0-SNAPSHOT"};
</script>


    <!-- start:inject meta-components [head] -->
    

        
            
        

        
            
        
    
    <!-- end:inject meta-components [head] -->



    <!-- start:inject meta-components [head] -->
    

        
            
        

        
            
        
    
    <!-- end:inject meta-components [head] -->









<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />

</head>

<body>
<header>

  <div class="logo">
    <a href="/">
      <figure class="image">
        <img src="https://monkeypatch.io/kaval/assets/logo/kaval.svg" alt="Kaval logo">
        <figcaption>Kaval</figcaption>
      </figure>
    </a>
  </div>

  <nav class="menu">
  
    <div class="separator">
      
        Getting Started
      
    </div>
  
    <div class="page">
      
        <a href="https://monkeypatch.io/kaval/samples">
          
            <i class="fas fa-code"></i>
          
          Samples
        </a>
      
    </div>
  
    <div class="separator">
      
        Modules
      
    </div>
  
    <div class="page">
      
        <a href="https://monkeypatch.io/kaval/kaval-core">
          
            <i class="fas fa-atom"></i>
          
          Kaval Core
        </a>
      
    </div>
  
    <div class="page">
      
        <a href="https://monkeypatch.io/kaval/kaval-arrow">
          
            <i class="fas fa-location-arrow"></i>
          
          Kaval Arrow
        </a>
      
    </div>
  
    <div class="page">
      
        <a href="https://monkeypatch.io/kaval/kaval-coroutine">
          
            <i class="fas fa-random"></i>
          
          Kaval Coroutine
        </a>
      
    </div>
  
    <div class="page">
      
        <a href="https://monkeypatch.io/kaval/kaval-kotest">
          
            <i class="fas fa-vial"></i>
          
          Kaval Kotest
        </a>
      
    </div>
  
    <div class="separator">
      
        Open Source
      
    </div>
  
    <div class="page">
      
        <a href="https://monkeypatch.io/kaval/license">
          
            <i class="fas fa-file-contract"></i>
          
          License
        </a>
      
    </div>
  
    <div class="page">
      
        <a href="https://monkeypatch.io/kaval/changelog">
          
            <i class="fas fa-history"></i>
          
          Changelog
        </a>
      
    </div>
  
    <div class="link">
      
        <a href="https://github.com/MonkeyPatchIo/kaval">
          
            <i class="fab fa-github"></i>
          
          Github
        </a>
      
    </div>
  
  </nav>

  <div class="flex-spacer"></div>

  <div class="version">
    Last version <a href="https://monkeypatch.io/kaval/changelog">0.6.0-SNAPSHOT</a>
  </div>

</header>

<main>
    <div class="content">
        
    <!-- start:inject components -->
    
        
            
                
                    
                        <h1 id="samples"><a href="#samples" id="samples" class="anchor"></a>Samples</h1>
<p>You can retrieve all these samples into the <a href="https://github.com/MonkeyPatchIo/kaval/tree/master/samples/src/main/kotlin">Github repository</a></p>
<h2 id="validate-a-pojo"><a href="#validate-a-pojo" id="validate-a-pojo" class="anchor"></a>Validate a POJO</h2>
<p>Let's write a validator for each POJO, here we use the companion object to declare the validator.</p>
<pre><code class="language-kotlin">import io.monkeypatch.kaval.core.Validator
import io.monkeypatch.kaval.core.nullOr
import io.monkeypatch.kaval.core.validator.Comparables.greaterThan
import io.monkeypatch.kaval.core.validator.Strings.maxLength
import io.monkeypatch.kaval.core.validator.Strings.notBlank
import io.monkeypatch.kaval.reflect.reflectValidator

data class User(
    val firstName: String,
    val lastName: String,
    val address: Address?
) {
    companion object {
     /**
      * A [User] is valid when:
      * - firstName is not blank and length &lt;= 128
      * - lastName is not blank and length &lt;= 255
      * - address is valid if not null
      */
     val validator: Validator&lt;User&gt; =
         reflectValidator {
             User::firstName { notBlank and maxLength(128) }
             User::lastName { notBlank and maxLength(255) }
             User::address { nullOr { Address.validator } }
         }
    }
}

data class Address(
    val line1: String,
    val line2: String,
    val zipCode: Int,
    val city: String
) {
    companion object {
     /**
      * An [Address] is valid when:
      * - the line1 is not blank and length &lt;= 255
      * - the line2 length &lt;= 255
      * - the zipCode is &gt; 0
      * - the city is not blank
      */
     val validator: Validator&lt;Address&gt; =
         reflectValidator {
             Address::line1 { notBlank and maxLength(255) }
             Address::line2 { maxLength(255) }
             Address::zipCode { greaterThan(0) }
             Address::city { notBlank }
         }
    }
}
</code></pre>
<h2 id="validate-a-nullable-object"><a href="#validate-a-nullable-object" id="validate-a-nullable-object" class="anchor"></a>Validate a nullable object</h2>
<p>To validate an object only when it's not null, use the <code>io.monkeypatch.kaval.core.nullOr</code></p>
<pre><code class="language-kotlin">import io.monkeypatch.kaval.core.Validator
import io.monkeypatch.kaval.core.nullOr
import io.monkeypatch.kaval.core.validator.Strings.matches

/**
 * A validator that accept null, or a String matching [Regex] `pl.*p`
 */
val plopValidator: Validator&lt;String?&gt; = nullOr {
    matches(Regex(&quot;pl.*p&quot;))
}
</code></pre>
<h2 id="validate-a-collection"><a href="#validate-a-collection" id="validate-a-collection" class="anchor"></a>Validate a collection</h2>
<p>You can retrieve some useful collection validators <a href="./kaval-core#collections">here</a></p>
<pre><code class="language-kotlin">import io.monkeypatch.kaval.core.Validator
import io.monkeypatch.kaval.core.validator.Collections.allValid
import io.monkeypatch.kaval.core.validator.Comparables.greaterThan

/**
 * Validate a list of int, where all int should be &gt; 9
 */
val listValidator: Validator&lt;List&lt;Int&gt;&gt; = allValid { greaterThan(9) }
</code></pre>
<h3 id="validate-a-sealed-class"><a href="#validate-a-sealed-class" id="validate-a-sealed-class" class="anchor"></a>Validate a sealed class</h3>
<p>You can combine validators that matching sub-classes with <code>io.monkeypatch.kaval.core.whenIsInstance</code></p>
<pre><code class="language-kotlin">import io.monkeypatch.kaval.core.Validator
import io.monkeypatch.kaval.core.field
import io.monkeypatch.kaval.core.validator.Ints.inRange
import io.monkeypatch.kaval.core.whenIsInstance

/**
 * Let's define a sealed hierarchy for HttpStatus
 */
sealed class HttpStatus {

    data class Ok(val statusCode: Int) : HttpStatus()

    data class Error(val statusCode: Int) : HttpStatus()

    data class ServerError(val statusCode: Int) : HttpStatus()

    companion object {

        /**
         * Validate the status statusCode for each HttpStatus variant
         */
        val validator: Validator&lt;HttpStatus&gt; = whenIsInstance&lt;HttpStatus, Ok&gt; {
            // Only check when is an instance of HttpStatus.Ok
            field(&quot;statusCode&quot;, Ok::statusCode) { inRange(200..299) }
        } and whenIsInstance {
            // Only check when is an instance of HttpStatus.Error
            field(&quot;statusCode&quot;, Error::statusCode) { inRange(400..499) }
        } and whenIsInstance {
            // Only check when is an instance of HttpStatus.ServerError
            field(&quot;statusCode&quot;, ServerError::statusCode) { inRange(500..599) }
        }
    }
}
</code></pre>
<h3 id="using-arrow-validated"><a href="#using-arrow-validated" id="using-arrow-validated" class="anchor"></a>Using Arrow Validated</h3>
<p>If you import the <code>io.monkeypatch.kaval.arrow.KavalValidated.check</code> extension, you can return an Arrow <code>Validated</code></p>
<pre><code class="language-kotlin">import io.monkeypatch.kaval.arrow.KavalValidated.check

val addressOk = Address(
    line1 = &quot;42 avenue Monoid&quot;,
    line2 = &quot;Semigroup block&quot;,
    zipCode = 42000,
    city = &quot;LambdaCity&quot;
)

val addressKo = Address(
    line1 = &quot; &quot;.repeat(500),
    line2 = &quot;&quot;,
    zipCode = -1,
    city = &quot;&quot;
)

println(addressOk.check(Address.validator))
// Valid(Address(line1=42 avenue Monoid, line2=Semigroup block, zipCode=42000, city=LambdaCity))

println(addressKo.check(Address.validator))
// Invalid(
//   NonEmptyList([
//     [line1] requires to be not blank,
//     [line1.length] requires to be lower or equals to 255, got 500,
//     [zipCode] requires to be greater than 0, got -1,
//     [city] requires to be not blanks
//   ])
// )
</code></pre>
<h3 id="using-arrow-either"><a href="#using-arrow-either" id="using-arrow-either" class="anchor"></a>Using Arrow Either</h3>
<p>If you import the <code>io.monkeypatch.kaval.arrow.KavalEither.check</code> extension, you can return an Arrow <code>Either</code></p>
<pre><code class="language-kotlin">import io.monkeypatch.kaval.arrow.KavalEither.check

val addressOk = Address(
    line1 = &quot;42 avenue Monoid&quot;,
    line2 = &quot;Semigroup block&quot;,
    zipCode = 42000,
    city = &quot;LambdaCity&quot;
)

val addressKo = Address(
    line1 = &quot; &quot;.repeat(500),
    line2 = &quot;&quot;,
    zipCode = -1,
    city = &quot;&quot;
)

println(addressOk.check(Address.validator))
// Right(Address(line1=42 avenue Monoid, line2=Semigroup block, zipCode=42000, city=LambdaCity))

println(addressKo.check(Address.validator))
// Left(InvalidException(invalid=Invalid:
//  - [line1] requires to be not blank
//  - [line1.length] requires to be lower or equals to 255, got 500
//  - [zipCode] requires to be greater than 0, got -1
//  - [city] requires to be not blank))
</code></pre>

                    
                
            
        
    
    <!-- end:inject components -->


    </div>
</main>
<footer>

  <div class="orchid">
    Build with <a href="https://orchid.run"><img alt="Orchid" src="https://monkeypatch.io/kaval/assets/logo/orchid.svg"></a>
  </div>
  <div class="flex-spacer"></div>
  <div class="love">We ❤️ Chocolatines</div>

</footer>

<!-- start:inject scripts -->
<script data-selector="pre code[class='language-run-kotlin']" src="https://monkeypatch.io/kaval/kotlin-playground@1"></script>
<script  src="https://monkeypatch.io/kaval/ajax/libs/prism/1.17.1/prism.min.js"></script>
<script  src="https://monkeypatch.io/kaval/ajax/libs/prism/1.17.1/components/prism-clike.min.js"></script>
<script  src="https://monkeypatch.io/kaval/ajax/libs/prism/1.17.1/components/prism-kotlin.min.js"></script>
<!-- end:inject scripts -->



</body>

</html>
